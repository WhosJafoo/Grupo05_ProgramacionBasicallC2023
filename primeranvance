import random
import time
import getpass

usuarios_Registrados = []

# MENU PRINCIPAL DEL CASINO


def mostrar_Menu():
    print("Bienvenido a DreamWorld Casino")
    print("Seleccione una opción:")
    print("1. Registro de usuario nuevo")
    print("2. DreamWorld Casino")
    print("3. Configuración Avanzada")
    print("4. Salir")

# PASOS PARA REGISTRAR UN USUARIO Y SE PREGUNTA CUANTO DINERO QUIERE DEPOSITAR Y LA MONEDA


def register_Usuario():
    print("NUEVO USUARIO!!")
    attempts = 0
    while attempts < 3:
        id_Usuario = getpass.getpass("Ingrese un nombre de usuario o ID: ")
        if len(id_Usuario) < 5:
            print("El ID debe tener al menos cinco caracteres")
        elif id_Usuario in usuarios_Registrados:
            print("El ID ingresado ya está registrado")
        else:
            nombre = input("Ingrese su nombre: ")
            pin = getpass.getpass("Ingrese su PIN (mínimo de 6 dígitos): ")
            if len(pin) < 6:
                print("PIN inválido, mínimo seis dígitos.")
            else:
                pin_confirmation = getpass.getpass("Ingrese de nuevo su PIN: ")
                if pin != pin_confirmation:
                    print("Los PINS no coinciden!")
                else:
                    deposito_Minimo = 1000  # Monto mínimo de depósito en dólares

                    intentos_Deposito = 3
                    while intentos_Deposito > 0:
                        moneda = input(
                            "Ingrese la moneda de su depósito (dólares, colones o bitcoin): ")
                        monto_Deposito = float(
                            input("Ingrese el monto a depositar: "))

                        if moneda == "dólares":
                            if monto_Deposito >= deposito_Minimo:
                                usuarios_Registrados.append(id_Usuario)
                                print(
                                    "Registro exitoso. ¡Bienvenido al DreamWorld Casino!")
                                intentos_Deposito = 0
                            else:
                                print(
                                    f"El depósito mínimo es de {deposito_Minimo} dólares.")
                                intentos_Deposito -= 1
                                if intentos_Deposito > 0:
                                    print(
                                        f"Intentos restantes: {intentos_Deposito}")
                        elif moneda == "colones":
                            tipo_Cambio = 0.001  # Tipo de cambio dólar-colón
                            monto_Deposito_Dolares = monto_Deposito * tipo_cambio
                            if monto_Deposito_Dolares >= deposito_Minimo:
                                usuarios_Registrados.append(id_Usuario)
                                print(
                                    "Registro exitoso. ¡Bienvenido al DreamWorld Casino!")
                                intentos_Deposito = 0
                            else:
                                print(
                                    f"El depósito mínimo es de {deposito_Minimo} dólares.")
                                intentos_Deposito -= 1
                                if intentos_Deposito > 0:
                                    print(
                                        f"Intentos restantes: {intentos_Deposito}")
                        elif moneda == "bitcoin":
                            tipo_Cambio = 35000  # Tipo de cambio dólar-bitcoin
                            monto_Deposito_Dolares = monto_Deposito * tipo_Cambio
                            if monto_Deposito_Dolares >= deposito_Minimo:
                                usuarios_Registrados.append(id_Usuario)
                                print(
                                    "Registro exitoso. ¡Bienvenido al DreamWorld Casino!")
                                intentos_Deposito = 0
                            else:
                                print(
                                    f"El depósito mínimo es de {deposito_Minimo} dólares.")
                                intentos_Deposito -= 1
                                if intentos_Deposito > 0:
                                    print(
                                        f"Intentos restantes: {intentos_Deposito}")
                        else:
                            print("Moneda no válida. Intente nuevamente.")
                    break
        attempts += 1
    print("Se excedió el máximo de intentos para ingresar un ID válido, volviendo al menú principal")

# INSTRUCCIONES DEL TRAGAMONEDAS


def mostrar_instrucciones():
    print("Instrucciones del juego:")
    print("1. Debes apostar al menos $100 para jugar.")
    print("2. Presiona la tecla J para jalar la palanca e iniciar el juego.")
    print("3. Cada ronda se mostrarán tres símbolos en pantalla.")
    print("4. Si aparecen tres @ en una ronda, recuperarás tu apuesta.")
    print("5. Si aparecen tres # en una ronda, ganarás el doble de tu apuesta.")
    print("6. Si aparecen tres 7 en una ronda, ganarás el acumulado.")
    print("7. El juego continuará hasta que decidas dejar de jugar.")

# JUEGO TRAGAMONEDAS


def jugar_tragamonedas(saldo):
    if saldo < 100:
        print("Debes apostar al menos $100 para jugar.")
        return saldo

    print("¡Bienvenido(a) a la tragamonedas!")
    print("Tu saldo actual es de $", saldo)
    while True:
        input_j = input("Presiona la tecla J para jalar la palanca: ")
        if input_j == 'J' or input_j == 'j':
            simbolos = ['@', '#', '+', '7']
            ronda = []
            for _ in range(3):
                simbolo = random.choice(simbolos)
                ronda.append(simbolo)
                print(simbolo, end=' ')
                time.sleep(1.5)
            print()

            if ronda.count('@') == 3:
                saldo += 100
                print("¡Felicidades! Recuperaste tu apuesta.")
            elif ronda.count('#') == 3:
                saldo *= 2
                print("¡Felicidades! Ganaste el doble de tu apuesta.")
            elif ronda.count('7') == 3:
                print("¡Felicidades! Ganaste el acumulado.")
                saldo += 1000
            else:
                saldo -= 100
                print("No tuviste suerte. Perdiste tu apuesta.")

            print("Tu saldo actual es de $", saldo)

            if saldo <= 0:
                print("Lo siento, te has quedado sin saldo.")
                break

            respuesta = input("¿Deseas seguir jugando? (S/N): ")
            if respuesta != 'S' and respuesta != 's':
                break
        else:
            print("Debes presionar la tecla J para jalar la palanca.")

# SUBMENU DE JUEGOS


def dreamworld_Casino():
    print("DreamWorld Casino")
    print("A. Tragamonedas ")
    print("B. BlackJack ")
    print("C. Volver al menu principal")

# CONFIGURACION AVANZADA
def configuracion_Avanzada():
    print("configuracion avanzada")
    global saldo_total  # variable global para modificarla

    monto_total = 0  # Inicializamos el monto total
    for moneda, monto in saldo_total.items():
        monto_total += monto

    nombre_usuario = input("Ingrese su nombre de usuario: ")
    print("Bienvenido,", nombre_usuario)

    opcionUsu = int(input("Indique la transacción que desea utilizar:\n"
                          "1) Retirar Dinero\n"
                          "2) Depositar Dinero\n"
                          "3) Ver Saldo Actual\n"
                          "4) Juegos en Linea\n"
                          "5) Eliminar Usuario\n"
                          "6) Salir\n"))

    if opcionUsu == 1:
        print("El monto actual de dinero que tiene disponible es de ¢",
              monto_total, "colones")
        resMonto = float(input("Digite el monto que desea retirar:\n"))
        if resMonto > monto_total:
            print(
                "El monto que desea retirar es mayor al disponible. NO se puede realizar la transacción")
        else:
            print("El monto que retiró es de ¢", resMonto, "colones")
            monto_total -= resMonto
            print("El monto que quedó disponible es de ¢", monto_total, "colones")

    elif opcionUsu == 2:
        diviDis = int(input("Bienvenido al menú para depositar dinero. Solo se aceptan las siguientes divisas:\n"
                            "1) Colones\n"
                            "2) Dólares\n"
                            "3) Bitcoin\n"))
        if diviDis == 1:
            print("La divisa que gusta utilizar es colones")
            depoColo = float(
                input("Digite la cantidad de colones que desea depositar:\n"))
            print("El monto que depositó es de ¢", depoColo, "colones")
            monto_total += depoColo
        elif diviDis == 2:
            print("La divisa que gusta utilizar es el dólar")
            depoDola = float(input("Indique el monto que desea depositar:\n"))
            conver = depoDola * 550
            print("El monto que depositó en dólares es de $", depoDola)
            print("El monto que depositó en colones es de ¢", conver, "colones")
            monto_total += conver
        elif diviDis == 3:
            print("La divisa seleccionada es el Bitcoin")
            depoBit = float(input("Digite el monto que desea depositar:\n"))
            converBit = depoBit * 26755
            converColo = converBit * 550
            print("El monto que depositó de Bitcoin es de", depoBit)
            print("Este monto equivale a $", converBit, "dólares")
            print("Este monto equivale a ¢", converColo, "colones")
            monto_total += converColo
        else:
            print("No existe esa opción en el menú")

    elif opcionUsu == 3:
        print("Su saldo actual es de ¢", monto_total, "colones")


def menu_Principal():
    usuarios_registrados = []  # Lista para almacenar los usuarios registrados
    saldo = 1000  # Saldo inicial del jugador

    while True:
        mostrar_Menu()
        option = input("Ingrese su opción: ")

        if option == "1":
            register_Usuario()
        elif option == "2":
            dreamworld_Casino()
            while True:  # aquí está el submenu para los juegos
                dreamworld_Casino()
                subopcion = input("Que desea jugar? ")

                if subopcion == "A":
                    print("Bienvenido al Tragamonedas")
                    mostrar_instrucciones()
                    saldo = jugar_tragamonedas(saldo)
                elif subopcion == "B":
                    print("Bienvenido a BlackJack")
                elif subopcion == "C":
                    print("Volviendo al Menu")
                    break
                else:
                    print("Opcion invalida")

        elif option == "3":
            configuracion_Avanzada()
        elif option == "4":
            print("¡Hasta luego!")
            break
        else:
            print("Opción inválida. Por favor, ingrese un número del 1 al 4.")


menu_Principal()

#Dreamwordl casino 
def cargar_usuarios():
    # Cargar la información de usuarios desde un archivo de texto y almacenarla en arreglos
    # Aquí deberías implementar la lectura del archivo de texto y cargar los usuarios en algún arreglo.

def verificar_usuarios():
    usuarios = cargar_usuarios()
    if len(usuarios) == 0:
        print("No hay usuarios registrados.")
        return False
    return True

import getpass

def auntenticar_usuario():
    intentos_id = 0
    usuarios = cargar_usuarios()

    while intentos_id < 3:
        id_usuario = input("Ingrese su ID:")

        # Verificar si el ID es válido y está registrado
        if id_usuario in usuarios:
            # Solicitar el pin de forma segura
            pin_usuario = getpass.getpass("Ingrese su PIN:")
            # Verificar si el PIN es correcto
            if verificar_pin(id_usuario, pin_usuario):
                return id_usuario  # Autenticación exitosa

        intentos_id += 1
        print("Se excedió el máximo de intentos para ingresar su ID.")
    
    return None

# Submenu y mensaje de bienvenida 
def mostrar_submenu(nombre_usuario):
    print(f"Bienvenido/a, {nombre_usuario}!")
    print("Seleccione una opción:")
    print("1. Retirar Dinero")
    print("2. Depositar Dinero")
    print("3. Ver saldo actual")
    print("4. Juegos en línea")
    print("5. Eliminar Usuario")
    print("6. Salir")
 #Retirar Dinero
        def retirar_dinero(id_usuario):
            saldo_actual=obtener_saldo(id_usuario)
            print("Saldo actual:",saldo_actual)

            intento_retiro=0

            while intentos_retiro < 3:
                monto_retiro=float(input("Ingrese el monto que desea retirar:"))

            if monto_retiro > saldo_actual:
                print("Monto solicitado mayor al saldo actual.Transaccion no realizada.")
                return
            intentos_retiro += 1

            print("Se excidió el maximo de intentos para ingresar el monto válido.")
            actualizar_saldo_archivo(id_usuario,saldo actual)#Actualizar saldo del archivo
            return
        def depositar_dinero(id_usuario):
            divisa_seleccionda=seleccionar_divisa()
            monto_deposito=float(input("Ingrese el monto que desea depositar:"))

         if monto_deposito<=0:
             print ("Monto invaido . Transaccion no realizada.")
             return

            monto_dolares=convertir_a_dolares(divisa_seleccionada,monto_deposito)
            saldo_actual=obtener_saldo(id_usuario)
            nuevo_saldo=saldo_actual + monto_dolares
            actualizar_saldo_archivo(id_usuario,nuevo_saldo)#Actualizar saldo en archivo

            print("Transaccion realizada de forma correcta.")
            print("Saldo actual:", nuevo_saldo)
            return

        def seleccionar_divisa():
            print("Divisas soportadas:")
            print("1. Colones")
            print("2. Dolares")
            print("3. Bitcoin")

            opcion=int(input("En que moneda desea depositar el dinero?"))
            if opcion ==1:
                return "colones"
            elif opcion ==2:
                return "bitcoin"
            else:
                print("Opcion invalida. Seleccionando dolares por defecto."
                      return "dolares"

                #Ver saldo actual
            def ver_saldo_actual(id_usuario):
                saldo_actual=obtener_saldo(id_usuario)
                print("Saldo actual.",saldo_actual)


                #Juegos en linea
            def juegos_en_linea():
                print("Seleccione un juego:")
                print("1. Blackjack")
                print("2. Tragamonedas")
                print("3. Salir")
                opcion=int(input())

                if opcion==1:
                    jugar_blackjack()
                    elif opcion==2:
                        jugar_tragamonedas()
                        elif opcion==3:()
                        return
                    else:
                        print("Opcion Invalida.")
